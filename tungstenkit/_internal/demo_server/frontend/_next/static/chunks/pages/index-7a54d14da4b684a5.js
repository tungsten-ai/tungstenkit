(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(356)}])},356:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return nj}});var r,i,s,o,l,a,c,u,d=t(5893),p=t(4523),x=t(9737),m=t(9008),h=t.n(m),f=t(5117),g=t(9985),j=t(2445),v=t(7294),y=t(741),b=t(7789),O=t(1232),C=t(7564),w=t(8818),T=t(2185),I=t(1163);function S(e){let n=(0,I.useRouter)(),{ref:t}=(0,T.h)(),{avatar:r,buttons:i,tabs:s,activeTab:o,align:l,children:a}=e,c=e=>{let t=s.find(n=>n.value===e);t&&n.push(t.link)},u=null!=s?(0,d.jsx)(y.m,{value:o,defaultValue:o,onTabChange:c,color:"violet-manual.3",styles:e=>({tab:{"&:hover":{backgroundColor:e.colors.gray[0],borderColor:e.colors.gray[5]},"&[data-active]":{fontWeight:600},fontSize:e.fontSizes.md,height:"2rem",minWidth:"100px",borderWidth:"3px"},tabsList:{display:"flex",borderBottom:"none",gap:"1rem"},tabLabel:{marginBottom:"5px"},tabRightSection:{paddingLeft:"5px",marginBottom:"3px"}}),children:(0,d.jsx)(y.m.List,{children:s.map(e=>(0,d.jsx)(y.m.Tab,{value:e.value,rightSection:void 0!==e.badgeLabel&&null!==e.badgeLabel?(0,d.jsx)(b.C,{size:"sm",children:e.badgeLabel}):null,children:e.label},e.value))})}):void 0;return(0,d.jsx)(j.W,{pt:"1.5rem",bg:"#F7F8FA",sx:e=>({borderBottom:"1.5px solid ".concat(e.colors.gray[3])}),className:"layout-container",children:(0,d.jsxs)(j.W,{className:"layout-container-inner",children:[(0,d.jsxs)(O.Z,{spacing:"0rem",position:"apart",align:null!=l?l:"center",children:[(0,d.jsxs)(O.Z,{spacing:"1.5rem",align:null!=l?l:"center",children:[(0,d.jsx)(p.x,{ref:t,children:r}),(0,d.jsx)(C.K,{spacing:"sm",children:Array.isArray(a)?a.map((e,n)=>(0,d.jsx)("div",{children:e},"header-body-element-".concat(n.toString()))):a})]}),(0,d.jsx)(p.x,{mt:"5px",children:Array.isArray(i)?i.map((e,n)=>(0,d.jsx)("div",{children:e},"header-button-".concat(n.toString()))):i})]}),(0,d.jsx)(w.T,{h:"1.5rem",w:"100%",mt:"0.5rem"}),u]})})}var E=t(9876),N=function(){return(0,d.jsx)(p.x,{w:"100%",mih:"3rem"})},k=function(e){let{header:n,children:t}=e;return(0,d.jsxs)(E.k,{direction:"column",sx:{minHeight:"100vh"},children:[n,(0,d.jsx)(E.k,{direction:"column",sx:{flexGrow:1},children:t}),(0,d.jsx)(E.k,{direction:"column",sx:{flexGrow:0},children:(0,d.jsx)(N,{})})]})};function L(e){let{model:n,children:t}=e,r=(0,d.jsx)(f.x,{size:"xxl",fw:500,inline:!0,children:n.name}),i=(0,d.jsx)(S,{avatar:(0,d.jsx)(g.q,{src:n.avatar_url,size:"70px",radius:"0"}),align:"center",children:r});return(0,d.jsx)(k,{header:i,children:(0,d.jsx)(j.W,{my:"2rem",className:"layout-container",children:(0,d.jsx)(j.W,{className:"layout-container-inner",children:t})})})}var _=t(6154);let F=()=>{let e=_.Z.create({timeout:3e3});return e};var R=t(6344),z=t(3356),Z=t(8767),B=function(e){return Object.freeze({axiosInstance:e,create:function(n){return e.post("/predictions",n,{headers:{accept:"application/json","Content-Type":"application/json"}})},get:function(n){return e.get("/predictions/".concat(n))},cancel:function(n){return e.post("/predictions/".concat(n,"/cancel"))}})};function A(e){let{failureReason:n,logsArea:t}=e;return(0,d.jsxs)(C.K,{children:[(0,d.jsx)(f.x,{color:"red.6",fw:500,children:function(e){switch(e){case"user_failure":return"Model run failed. See the logs below.";case"system_failure":return"An unexpected error occurred. If you encounter this repeatedly, please send us feedback.";case"timeout":return"Timeout Reached";default:return"ERROR".concat(e?": ".concat(e):"")}}(n)}),t]})}var P=t(966);function H(e){let{status:n,logsArea:t}=e;return(0,d.jsxs)(C.K,{children:[(0,d.jsxs)(O.Z,{children:[(0,d.jsx)(f.x,{fw:500,children:n.charAt(0).toUpperCase()+n.slice(1)}),(0,d.jsx)(P.a,{color:"gray",variant:"dots",size:"sm"})]}),t]})}var M=t(825);function W(e){let{title:n,rightIcon:t,children:r,...i}=e;return(0,d.jsxs)(M.Z,{withBorder:!0,padding:"lg",radius:"lg",h:"fit-content",...i,children:[(0,d.jsx)(M.Z.Section,{withBorder:!0,inheritPadding:!0,py:"sm",children:(0,d.jsxs)(O.Z,{position:"apart",children:["string"==typeof n?(0,d.jsx)(f.x,{fz:"xl",fw:600,children:n}):n,t]})}),(0,d.jsx)(p.x,{pt:"md",children:r})]})}var K=t(3523),U=t(2870);function q(){return(0,d.jsxs)(C.K,{align:"center",justify:"center",spacing:"lg",py:"xl",children:[(0,d.jsx)(K.M,{children:(0,d.jsx)(U.E,{mx:"auto",maw:"40%",opacity:.3,alt:"tungsten_logo",src:"/tungsten_greyed_out_logo.png"})}),(0,d.jsx)(f.x,{color:"gray.6",fz:"md",children:'Click "Run" to see amazing results.'})]})}var D=t(8104);function J(e){let{name:n,description:t,required:r}=e,i=(0,D.rZ)(),s=i.fn.variant({variant:"filled",color:"red"}).background;return(0,d.jsxs)(C.K,{spacing:"xxs",mb:"xs",children:[(0,d.jsxs)(p.x,{children:[(0,d.jsxs)(f.x,{fw:500,fz:"md",span:!0,children:[n," "]}),r&&(0,d.jsx)(f.x,{span:!0,color:s,children:"*"})]}),t?(0,d.jsx)(f.x,{color:"gray.7",fz:"sm",children:t}):void 0]})}var V=t(983),Y=t(2679),G=t(7297),X=t(7841),Q=t(2276),$=t(7311),ee=t(2015);function en(){let e=(0,G.Z)(["\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: center;\n  height: 100px;\n  width: 100%;\n  background: transparent;\n  gap: 2rem;\n"]);return en=function(){return e},e}function et(){let e=(0,G.Z)(["\n  width: 100%;\n  height: 90px;\n"]);return et=function(){return e},e}function er(){let e=(0,G.Z)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 60px;\n  height: 60px;\n  background: #e9e9e9;\n  border: 1px black;\n  outline: none;\n  cursor: pointer;\n  padding-bottom: 3px;\n  &:hover {\n    background: #ddd;\n  }\n"]);return er=function(){return e},e}let ei=ee.ZP.div(en()),es=ee.ZP.div(et());ee.ZP.button(er());var eo=function(e){let{src:n}=e,r=(0,v.useId)(),[i,s]=(0,v.useState)(!1),[o,l]=(0,v.useState)(),a=!0;(0,v.useEffect)(()=>{if(a){let e=async()=>{let e=(await t.e(33).then(t.t.bind(t,1796,23))).default,i=document.getElementById("waveform".concat(r)),o=e.create({barWidth:3,barRadius:3,barGap:2,barMinHeight:1,cursorWidth:1,container:i,backend:"WebAudio",height:80,progressColor:"#black",responsive:!0,waveColor:"#C4C4C4",cursorColor:"transparent"});l(o),o.load(n),o.on("finish",()=>{s(!1)})};e(),a=!1}},[]);let c=e=>{s(!i),e&&e.playPause()};return(0,d.jsx)(p.x,{sx:{maxWidth:"90%"},children:(0,d.jsx)(p.x,{style:{padding:"0px",margin:"0px"},children:(0,d.jsxs)(ei,{style:{padding:"0px",margin:"0px",height:"90px"},children:[(0,d.jsx)(X.z,{sx:e=>({border:"none",borderRadius:e.radius.sm,width:"120px"}),variant:"contained",leftIcon:i?(0,d.jsx)(Q.Z,{}):(0,d.jsx)($.Z,{}),onClick:e=>c(o),children:i?"Pause":"Play"}),(0,d.jsx)(es,{id:"waveform".concat(r),style:{padding:"0px",margin:"0px",height:"80px"}})," ",(0,d.jsx)("audio",{id:"track".concat(r),src:n,style:{padding:"0px",margin:"0px"}})]})})})},el=t(335);function ea(e){let{src:n}=e;return(0,d.jsx)(X.z,{component:"a",href:n,target:"_blank",variant:"default",leftIcon:(0,d.jsx)(el.Z,{size:"1rem"}),children:"Download file"})}var ec=t(5215);t(1717);var eu=function(e){let{src:n,mimeType:t,autoplay:r=!1,controls:i=!0,responsive:s=!0,fluid:o=!0}=e,l=(0,v.useRef)(null),a=(0,v.useRef)(null),c=(e,n)=>{n.current=e};return(0,v.useEffect)(()=>{let e={autoplay:r,controls:i,responsive:s,fluid:o,sources:[{src:n,type:t}]};if(a.current){let n=a.current;n.autoplay(e.autoplay),n.src(e.sources)}else{var u;let n=document.createElement("video-js");n.classList.add("vjs-big-play-centered"),null===(u=l.current)||void 0===u||u.appendChild(n);let t=a.current=(0,ec.Z)(n,e,()=>{c&&c(t,a)})}},[n,t,r,i,s,o,l]),(0,v.useEffect)(()=>{let e=a.current;return()=>{e&&!e.isDisposed()&&(e.dispose(),a.current=null)}},[a]),(0,d.jsx)(E.k,{direction:"column",sx:{maxWidth:"100%",gap:"0.4rem"},children:(0,d.jsx)(p.x,{"data-vjs-player":!0,children:(0,d.jsx)("div",{ref:l,style:{}})})})};let ed=e=>{if("string"!=typeof e)return e.type;let n=(0,V.lookup)(e);return n||"application/octet-stream"},ep=(0,v.forwardRef)((e,n)=>{let t;let{file:r,filetype:i}=e,[s,o]=(0,v.useState)("string"==typeof r?r:URL.createObjectURL(r)),l=ed(r),a=(0,d.jsx)(p.x,{});switch((0,v.useEffect)(()=>{o("string"==typeof r?r:URL.createObjectURL(r))},[r]),i){case"image":t=s?(0,d.jsx)(Y.LazyLoadImage,{src:s,style:{maxWidth:"100%",maxHeight:"100%"},alt:i}):a;break;case"video":t=s?(0,d.jsx)(eu,{src:s,mimeType:l}):a;break;case"audio":t=s?(0,d.jsx)(eo,{src:s}):a;break;default:t=s?(0,d.jsx)(ea,{src:s}):a}return(0,d.jsx)(p.x,{maw:"100%",mah:"100%",ref:n,children:t})});function ex(e,n){if(n)return s.FILE;if(e.choices&&e.type&&["string","number","integer"].includes(e.type)){if("string"===e.type)return s.STR_CHOICE;if("integer"===e.type)return s.INT_CHOICE;if("number"===e.type)return s.FLOAT_CHOICE}return"integer"===e.type?void 0!==e.minimum||void 0!==e.maximum?s.CONINT:s.INT:"number"===e.type?void 0!==e.minimum||void 0!==e.maximum?s.CONFLOAT:s.FLOAT:"boolean"===e.type?s.BOOL:void 0!==e.min_length||void 0!==e.max_length?s.CONSTR:s.STR}ep.defaultProps={filetype:"binary"},ep.displayName="FileView",(r=s||(s={}))[r.FILE=0]="FILE",r[r.STR=1]="STR",r[r.CONSTR=2]="CONSTR",r[r.INT=3]="INT",r[r.CONINT=4]="CONINT",r[r.FLOAT=5]="FLOAT",r[r.CONFLOAT=6]="CONFLOAT",r[r.BOOL=7]="BOOL",r[r.STR_CHOICE=8]="STR_CHOICE",r[r.INT_CHOICE=9]="INT_CHOICE",r[r.FLOAT_CHOICE=10]="FLOAT_CHOICE",(i=o||(o={}))[i.FILE=0]="FILE",i[i.FILE_LIST=1]="FILE_LIST",i[i.FILE_DICT=2]="FILE_DICT",i[i.STR=3]="STR",i[i.NUMBER=4]="NUMBER",i[i.BOOL=5]="BOOL",i[i.JSON=6]="JSON";var em=t(2328),eh=t(665),ef=t(7577),eg=t(5887),ej=t(8393),ev=t(9834),ey=t(8198),eb=t(3625);function eO(e){let{value:n,iconSize:t,...r}=e;return(0,d.jsx)(ef.a,{opacity:0,sx:{pointerEvents:"none"},...r,children:(0,d.jsx)(O.Z,{position:"right",align:"center",children:(0,d.jsx)(eg.q,{value:"string"==typeof n?n:n.toString(),timeout:2e3,children:e=>{let{copied:n,copy:r}=e;return(0,d.jsx)(ej.u,{label:n?"Copied":"Copy",withArrow:!0,position:"bottom",children:(0,d.jsx)(ev.A,{variant:"light",color:n?"button-blue":"gray",onClick:r,sx:{pointerEvents:"all"},children:n?(0,d.jsx)(ey.Z,{size:t}):(0,d.jsx)(eb.Z,{size:t})})})}})})})}eO.defaultProps={iconSize:"1rem"};var eC=t(6817),ew=t(6768),eT=(0,eC.k)((e,n)=>{let{color:t}=n,r=t||("dark"===e.colorScheme?"dark":"gray"),i=e.fn.variant({color:r,variant:"light"});return{root:{...e.fn.fontStyles(),lineHeight:e.lineHeight,padding:"".concat((0,ew.h)(2)," calc(").concat(e.spacing.xs," / 2)"),borderRadius:e.radius.sm,color:"dark"===e.colorScheme?"dark"===r?e.colors.dark[0]:e.white:e.colors.dark[7],backgroundColor:"dark"===e.colorScheme&&"dark"===r?e.colors.dark[5]:i.background,fontFamily:e.fontFamilyMonospace,fontSize:e.fontSizes.xs},block:{padding:e.spacing.xs,margin:0,whiteSpace:"pre-wrap",wordBreak:"break-all"}}});let eI={fz:"sm"},eS=(0,v.forwardRef)((e,n)=>{let{className:t,children:r,color:i,unstyled:s,variant:o,mono:l,ff:a,noCopy:c,...u}=(0,D.N4)("Code",eI,e),{classes:x,cx:m}=eT({color:i},{name:"Code",unstyled:s,variant:o}),h=(0,D.rZ)(),{ref:f,x:g,y:j}=(0,em.i)({resetOnExit:!0}),v=(0,eh.Y)(f,n);return(0,d.jsx)(p.x,{ff:null!=a?a:l?h.fontFamilyMonospace:h.fontFamily,className:m(x.root,x.block,t),ref:v,...u,children:(0,d.jsxs)(p.x,{pos:"relative",children:[null!=r&&""!==r?r:(0,d.jsx)(p.x,{children:"\xa0"}),!0!==c&&(0!==g||0!==j)&&null!=r&&""!==r&&(0,d.jsx)(eO,{value:"string"==typeof r?r:r.toString(),iconSize:"1rem"})]})})});function eE(e){let{fieldName:n,propObj:t,filetype:r,itemFiletype:i,value:s}=e,l=function(e,n,t){let r=Object.keys(e),i="array"===e.type,s="object"===e.type&&r.includes("additionalProperties");return n?o.FILE:i&&t?o.FILE_LIST:s&&t?o.FILE_DICT:"integer"===e.type||"number"===e.type?o.NUMBER:"boolean"===e.type?o.BOOL:"string"===e.type?o.STR:o.JSON}(t,r,i);switch(l){case o.FILE:return(0,d.jsx)(ep,{file:s,filetype:r});case o.FILE_LIST:return(0,d.jsx)(C.K,{spacing:"xxs",children:s.map((e,r)=>(0,d.jsx)(eE,{fieldName:"".concat(n,"-").concat(r.toString()),propObj:t.items,filetype:i,value:e},"".concat(n,"-").concat(r.toString())))});case o.FILE_DICT:return(0,d.jsx)(C.K,{spacing:"xxs",children:Object.keys(s).map(e=>(0,d.jsxs)("div",{children:[(0,d.jsx)(J,{description:e},e),(0,d.jsx)(eE,{fieldName:"".concat(n,"-").concat(e),propObj:t.additionalProperties,filetype:i,value:s[e]})]},"".concat(n,"-").concat(e)))});case o.STR:return(0,d.jsx)(eS,{children:s});case o.BOOL:case o.NUMBER:return(0,d.jsx)(eS,{children:s.toString()});case o.JSON:return(0,d.jsx)(eS,{children:JSON.stringify(s,void 0,2)});default:throw TypeError("Unkown output field type ".concat(l," "))}}function eN(e){let{schema:n,filetypes:t,values:r,spacing:i}=e,s=[];return Object.keys(n.properties).forEach(e=>{s.push({name:e,component:function(e){let i=n.properties[e],s=t[e];return(0,d.jsx)(eE,{fieldName:e,propObj:i,filetype:s,itemFiletype:t["".concat(e,".$item")],value:r[e]})}(e)})}),(0,d.jsx)(C.K,{fz:"md",spacing:i,children:s.map(e=>(0,d.jsxs)("div",{children:[(0,d.jsx)(J,{name:e.name}),e.component]},"output-field-".concat(e.name)))})}eS.displayName="CodeBlockWithLinebreak",eN.defaultProps={spacing:"md"};var ek=t(3723);function eL(e){let{children:n,autoScroll:t,fz:r,h:i}=e,s=(0,v.useRef)(null),{ref:o,width:l,height:a}=(0,T.h)(),{ref:c,x:u,y:x}=(0,em.i)({resetOnExit:!0}),m=(0,eh.Y)(o,c),h=!!t&&(0===u||0===x),f=e=>{var n;null==s||null===(n=s.current)||void 0===n||n.scrollTo({top:s.current.scrollHeight,behavior:e})};return(0,v.useEffect)(()=>{t&&h&&f(t)},[h,t,n]),(0,d.jsxs)(p.x,{pos:"relative",ref:m,children:[(0,d.jsx)(ek.x,{viewportRef:s,h:i,children:(0,d.jsx)(eS,{fz:r,miw:l,mih:a,mono:!0,noCopy:!0,children:n})}),(0!==u||0!==x)&&(0,d.jsx)(eO,{p:".3rem",value:null!=n?n:""})]})}function e_(e){let{mode:n,output:t,demoOutput:r,demoOutputSchema:i,demoOutputFiletypes:s,logs:o}=e,l=(0,d.jsx)(eN,{schema:i,filetypes:s,values:r}),a=(0,d.jsx)(eS,{fz:"xs",mono:!0,children:JSON.stringify(t,null,2)}),c=(0,d.jsx)(eL,{children:null!=o?o:""});return(0,d.jsxs)(d.Fragment,{children:["preview"===n&&l,"raw"===n&&a,"logs"===n&&c]})}eL.defaultProps={fz:"xs",h:"30vh",children:""};var eF=t(3819),eR=t(5158),ez=t(2972),eZ=t(7080);function eB(e){let{icon:n,label:t}=e;return(0,d.jsxs)(K.M,{children:[n,(0,d.jsx)(p.x,{ml:10,children:t})]})}function eA(e){let{mode:n,onChange:t,w:r,iconSize:i,...s}=e,o={size:void 0===i?"1rem":i};return(0,d.jsx)(eF.s,{value:n,onChange:t,w:null!=r?r:"100%",data:[{label:(0,d.jsx)(eB,{icon:(0,d.jsx)(eR.Z,{...o}),label:"Preview"}),value:"preview"},{label:(0,d.jsx)(eB,{icon:(0,d.jsx)(ez.Z,{...o}),label:"Raw"}),value:"raw"},{label:(0,d.jsx)(eB,{icon:(0,d.jsx)(eZ.Z,{...o}),label:"Logs"}),value:"logs"}],...s})}var eP=t(930),eH=t(2615),eM=t(4796),eW=t(2675),eK=t(8431),eU=t(1885),eq=t(1500),eD=t(6261),eJ=t(971),eV=t(4151),eY=t(3540),eG=t(5851),eX=t(7339),eQ=t(8044),e$=t(5204),e0=t(6862),e1=t(904),e5=t(7283);let e3={iconSize:"1.1rem",textProps:{fz:"md"}};function e7(e){let n;let{wrapperProps:t,value:r,defaultValue:i,filetype:s,onChange:o,textProps:l,maxsize:a,iconSize:c}=(0,eD.k)("DropzoneInput",e3,e),[u,x]=(0,eG.C)({value:r,onChange:o,finalValue:null}),m=(0,D.rZ)();return i&&x(i),(0,d.jsx)(eV.I.Wrapper,{...t,children:(0,d.jsxs)(C.K,{spacing:"xs",children:[u?function(e){let n=(0,d.jsx)(ep,{file:e,filetype:s}),t=typeof e!==i?(0,d.jsxs)(O.Z,{maw:"100%",spacing:"xs",children:[(0,d.jsx)(f.x,{fz:"xs",color:"gray.7",children:"string"==typeof e?decodeURI(e.split("/").pop()):"".concat(e.name," (").concat(function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(!+e)return"0 Bytes";let t=Math.floor(Math.log(e)/Math.log(1024));return"".concat(parseFloat((e/Math.pow(1024,t)).toFixed(n<0?0:n))," ").concat(["Bytes","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"][t])}(e.size),")")}),(0,d.jsx)(eJ.P,{title:"Delete file",color:"gray.7",onClick:()=>x(null)})]}):void 0;return(0,d.jsxs)(C.K,{spacing:"xs",maw:"100%",children:["image"===s?(0,d.jsx)(p.x,{maw:"50%",children:n}):n,t]})}(u):void 0,(0,d.jsx)(eY.fh,{onDrop:e=>{e.length>0&&void 0!==o&&(x(e[0]),o(e[0]))},maxSize:a,accept:function(){if(["audio","video","image"].includes(s)){let e={};for(let[n,t]of Object.entries(V.extensions))n.startsWith(s)&&(e[n]=t.map(e=>".".concat(e)));return e}}(),maxFiles:1,children:(0,d.jsxs)(O.Z,{position:"center",spacing:"md",style:{pointerEvents:"none"},children:[(0,d.jsx)(eY.fh.Accept,{children:(0,d.jsx)(e1.Z,{color:m.colors[m.primaryColor][5],size:c})}),(0,d.jsx)(eY.fh.Reject,{children:(0,d.jsx)(e5.Z,{color:m.colors.red[6],size:c})}),(0,d.jsx)(eY.fh.Idle,{children:(n="image"===s?eX.Z:"video"===s?eQ.Z:"audio"===s?e$.Z:e0.Z,(0,d.jsx)(n,{size:c}))}),(0,d.jsxs)(f.x,{inline:!0,...l,children:["Drag ",s," file here or click to select"]})]})})]})})}var e2=t(6801);let e8="This field is required.",[e4,e6,e9]=(0,e2.W)(),ne=e=>{let{schema:n,filetypes:t,initialValues:r}=e,i=Object.keys(n.properties),o=Object.fromEntries(i.map(e=>[e,r&&r[e]?r[e]:function(e){let r=n.properties[e],i=ex(r,t[e]),o=r.default;if(null==o)switch(i){case s.STR:case s.CONSTR:case s.INT:case s.FLOAT:case s.CONINT:case s.CONFLOAT:o="";break;case s.BOOL:o=!1;break;default:o=null}return o}(e)])),{onSubmit:l,values:a,setFieldValue:c,isTouched:u,setTouched:d,...p}=e9({initialValues:o,validate:Object.fromEntries(i.map(e=>[e,function(e){let r=n.properties[e],i=null!=n.required&&n.required.includes(e),o=ex(r,t[e]),l=e=>null==e?i?e8:void 0:"string"!=typeof e&&"string"==typeof e&&!function(e){let n;try{n=new URL(e)}catch(e){return!1}return"http:"===n.protocol||"https:"===n.protocol}(e)?"Not an HTTP(s) URL.":void 0,a=e=>{if(null==e)return i?e8:void 0;if("string"!=typeof e)throw TypeError("Invalid type for string form");return 0===e.length?i?e8:void 0:void 0!==r.max_length&&e.length>r.max_length?"Maximum length is ".concat(r.max_length," characters."):void 0!==r.min_length&&e.length<r.min_length?"Minimum length is ".concat(r.min_length," characters."):void 0},c=e=>{if(null==e||"string"==typeof e&&0===e.length)return i?e8:void 0;if("number"!=typeof e)throw TypeError("Invalid type for number form");return void 0!==r.maximum&&e>r.maximum?"Maximum value is ".concat(r.maximum):void 0!==r.minimum&&e<r.minimum?"Minimum value is ".concat(r.minimum,"."):void 0};switch(o){case s.FILE:return l;case s.STR:case s.CONSTR:case s.STR_CHOICE:return a;case s.CONFLOAT:case s.FLOAT:case s.CONINT:case s.INT:case s.INT_CHOICE:case s.FLOAT_CHOICE:return c;default:return}}(e)]))}),x=(e,t)=>{let r=(t,r)=>e(Object.fromEntries(i.map(e=>[e,function(e,t){let r=n.properties[e];return null==t?r.default:t}(e,t[e])])),r);return l(r,t)};return{onSubmit:x,values:a,setFieldValue:c,isTouched:u,setTouched:d,...p}},nn=()=>({placeholder:"Select one",rightSection:(0,d.jsx)(eq.Z,{size:"1rem"})}),nt=e=>({min:null!==(l=e.minimum)&&void 0!==l?l:void 0,max:null!==(a=e.maximum)&&void 0!==a?a:void 0,styles:{markLabel:{display:"none"},label:{display:"none"}}}),nr=e=>({min:null!==(c=e.minimum)&&void 0!==c?c:void 0,max:null!==(u=e.maximum)&&void 0!==u?u:void 0,stepHoldDelay:500,stepHoldInterval:100,removeTrailingZeros:!0});function ni(e){let{fieldName:n,fieldProp:t,filetype:r}=e,i=e6(),o=i.getInputProps(n),l=ex(t,r);switch(l){case s.FILE:return(0,d.jsx)(e7,{filetype:r,maxsize:1073741824,iconSize:"1.1rem",textProps:{size:"sm"},...o});case s.STR:case s.CONSTR:return(0,d.jsx)(eH.g,{autosize:!0,minRows:1,...o});case s.INT:case s.FLOAT:return(0,d.jsx)(eM.Y,{w:"100%",precision:l===s.INT?1:10,step:l===s.INT?1:.01,...nr(t),...o});case s.CONINT:case s.CONFLOAT:return(0,d.jsxs)(O.Z,{spacing:"1rem",children:[(0,d.jsx)(eM.Y,{w:"calc(30% - 1rem)",precision:l===s.CONINT?0:10,step:l===s.CONINT?1:.01,...nr(t),...o}),(0,d.jsx)(eW.i,{w:"70%",value:o.value,onChange:o.onChange,step:l===s.CONINT?1:.01,...nt(t)})]});case s.STR_CHOICE:if(null==t.choices)throw TypeError("No choices");return(0,d.jsx)(eK.Ph,{data:t.choices,...o,...nn()});case s.BOOL:return(0,d.jsx)(eU.r,{...o});case s.INT_CHOICE:case s.FLOAT_CHOICE:if(null==t.choices)throw TypeError("No choices");return(0,d.jsx)(eK.Ph,{value:null!=o.value?o.value.toString():null,data:t.choices.map(e=>e.toString()),onChange:e=>{let n=null;"string"==typeof e&&(n=Number(e)),o.onChange(n)},...Object.fromEntries(Object.entries(o).filter(e=>!["onChange","value"].includes(e[0])))});default:throw TypeError("Unknown field type ".concat(l))}}function ns(e){let{filetype:n,value:t}=e;if(n)return(0,d.jsx)(ep,{file:t,filetype:n});if(void 0!==t)return(0,d.jsx)(eS,{children:"string"!=typeof t?t.toString():t});throw Error("`value` is undefined")}function no(e){let{withForm:n,schema:t,filetypes:r,values:i,showOptions:s,spacing:o}=e,l=[],a=[];function c(e){return(null==t?void 0:t.required)!=null&&(null==t?void 0:t.required.includes(e))}function u(e){let s=t.properties[e],o=r[e];return n?(0,d.jsx)(ni,{fieldName:e,fieldProp:s,filetype:o}):(0,d.jsx)(ns,{filetype:o,value:void 0===i?void 0:i[e]})}return Object.keys(t.properties).forEach(e=>{c(e)&&l.push({name:e,component:u(e)})}),Object.keys(t.properties).forEach(e=>{c(e)||a.push({name:e,component:u(e)})}),(0,d.jsxs)(p.x,{fz:"md",children:[(0,d.jsx)(C.K,{spacing:o,children:l.map(e=>(0,d.jsxs)("div",{children:[(0,d.jsx)(J,{name:e.name,required:!!n,description:n?t.properties[e.name].description:void 0}),e.component]},"input-field-".concat(e.name)))}),s&&a.length>0?(0,d.jsx)(w.T,{h:o}):void 0,(0,d.jsx)(eP.U,{in:null!=s&&s,children:(0,d.jsx)(C.K,{spacing:o,children:a.map(e=>(0,d.jsxs)("div",{children:[(0,d.jsx)(J,{name:e.name,required:!1,description:n?t.properties[e.name].description:void 0}),e.component]},"input-field-".concat(e.name)))})})]})}no.defaultProps={spacing:"md",values:void 0,showOptions:!1};var nl=t(8078);function na(e){let{checked:n,onChange:t,...r}=e;return(0,d.jsx)(nl.X,{label:"Show options",checked:n,onChange:e=>t(e.currentTarget.checked),...r})}var nc=t(3575);let nu={height:"3rem"},nd=e=>nc.N9.show({message:"".concat(e),color:"red",sx:nu});var np=t(4075);let nx=(0,v.forwardRef)((e,n)=>{var t,r;let i;let{prediction:s,model:o,setPrediction:l}=e,{demo_output_schema:a,demo_output_filetypes:c}=o,u=new z.Z,x=F(),m=B(x),[h,f]=(0,v.useState)("preview"),g=(0,Z.useMutation)({mutationFn:()=>(u.remove("current_prediction",{path:"/"}),l(null),m.cancel(s.id))}),j=(null==s?void 0:s.status)&&["pending","running"].includes(s.status)?"auto":"smooth",y=(0,d.jsx)(eL,{autoScroll:j,children:null!==(t=null==s?void 0:s.logs)&&void 0!==t?t:""}),b=(0,d.jsx)(w.T,{h:"md"}),C=(0,d.jsx)(w.T,{h:"xl"});switch(null==s?void 0:s.status){case"pending":case"running":i=(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(H,{status:s.status,logsArea:"running"===s.status?y:void 0}),b,(0,d.jsx)(X.z,{onClick:()=>g.mutate(),variant:"default",fullWidth:!0,children:"Cancel"})]});break;case"failed":i=(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(A,{failureReason:s.failure_reason,logsArea:y}),C]});break;case"success":i=(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(eA,{mode:h,onChange:f}),b,(0,d.jsx)(e_,{mode:h,output:s.output,demoOutput:s.demo_output,demoOutputSchema:a,demoOutputFiletypes:c,logs:null!==(r=null==s?void 0:s.logs)&&void 0!==r?r:""}),C,(0,d.jsx)(O.Z,{position:"right",children:(0,d.jsx)(X.z,{variant:"default",onClick:()=>{window.scrollTo({top:0,behavior:"auto"}),u.remove("current_prediction",{path:"/"}),l(null)},leftIcon:(0,d.jsx)(np.Z,{size:"1rem"}),children:"Clear"})})]});break;default:i=(0,d.jsx)(q,{})}return(0,d.jsx)(p.x,{ref:n,children:i})});nx.displayName="ModelRunProgress";var nm=t(8697);function nh(e){var n,t,r;let{model:i,onFormSubmit:s,onError:o}=e,{input_schema:l,input_filetypes:a}=i,c=(0,I.useRouter)(),u=F(),p=Object.freeze({axiosInstance:u,upload:function(e){let n=new FormData;return n.append("file",e),u.post("/files",n,{timeout:3e5,headers:{"Content-Type":"multipart/form-data"}})}}),[x,m]=(0,v.useState)(!1),[h,f]=(0,v.useState)(!1),[g,j]=(0,v.useState)(!1),{start:y}=(0,nm.K)(()=>j(!1),2e3),b=()=>{j(!0),y()},T=ne({schema:l,filetypes:a});null===(n=c.events)||void 0===n||n.on("routeChangeComplete",()=>{f(!1),j(!1)}),null===(t=c.events)||void 0===t||t.on("routeChangeError",()=>{f(!1),j(!1)});let S=async e=>e instanceof File?await p.upload(e).then(e=>e.data.serving_url).catch(()=>""):e,E=async e=>{f(!0),b();let n=Object.keys(i.input_schema.properties),t=n.filter(e=>!!i.input_filetypes[e]),r=t.map(n=>S(e[n])),l=await Promise.all(r);if(l.some(e=>""===e)){o(),f(!1);return}let a=Object.fromEntries(n.map(n=>{let r=t.indexOf(n);return r>=0?[n,l[r]]:[n,e[n]]}));s(a),f(!1)},{setValues:N}=T;return(0,d.jsxs)(C.K,{w:"100%",spacing:"0",children:[null!=(r=i.input_schema).required&&Object.keys(r.properties).some(e=>{var n;return!(null===(n=r.required)||void 0===n?void 0:n.includes(e))})?(0,d.jsx)(O.Z,{position:"right",children:(0,d.jsx)(na,{checked:x,onChange:m})}):void 0,(0,d.jsx)(e4,{form:T,children:(0,d.jsxs)("form",{onSubmit:T.onSubmit(E),children:[(0,d.jsx)(no,{withForm:!0,schema:l,filetypes:a,showOptions:x}),(0,d.jsx)(w.T,{h:"xxl"}),(0,d.jsxs)(O.Z,{position:"right",grow:!0,children:[(0,d.jsx)(X.z,{onClick:T.reset,leftIcon:(0,d.jsx)(np.Z,{size:"1rem"}),variant:"default",children:"Reset"}),(0,d.jsx)(X.z,{leftIcon:(0,d.jsx)($.Z,{size:"1rem"}),color:"run-green.4",loading:h||g,type:h||g?void 0:"submit",children:"Run"})]})]})})]})}let nf="Failed to run by unexpected server error";function ng(e){let{model:n}=e,t=F(),r=B(t),i=new z.Z,[s,o]=(0,v.useState)(null),{scrollIntoView:l,targetRef:a}=(0,R.g)({axis:"y"}),c=(0,Z.useMutation)({mutationFn:e=>{let n=r.create(e);return null!=s&&["pending","running"].includes(s.status)?r.cancel(s.id).then(()=>n):n},onSuccess:e=>{let{data:n}=e;i.set("current_prediction",n.id,{path:"/"}),o(n),l({alignment:"start"})},onError:()=>{nd(nf)}});return(0,Z.useQuery)({enabled:null!=s&&("running"===s.status||"pending"===s.status),retry:5,refetchInterval:500,queryKey:"",queryFn:()=>r.get(s.id),onSuccess:e=>o(e.data),onError:()=>nd("Failed to update the status from server")}),(0,d.jsxs)(O.Z,{w:"100%",spacing:"2rem",align:"top",grow:!0,children:[(0,d.jsx)(W,{title:"Input",children:(0,d.jsx)(nh,{model:n,onFormSubmit:c.mutate,onError:()=>nd(nf)})}),(0,d.jsx)(W,{title:"Output",children:(0,d.jsx)(nx,{ref:a,prediction:s,model:n,setPrediction:o})})]})}function nj(){let e=F(),n=Object.freeze({axiosInstance:e,get:function(){return e.get("/metadata")}}),[t,r]=(0,v.useState)(null);return(0,v.useLayoutEffect)(()=>{(async function(){await n.get().then(e=>r(e.data)).catch(()=>{nd("Failed to load model metadata by unexpected server error")})})()},[]),(0,d.jsxs)(p.x,{children:[t?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(h(),{children:[(0,d.jsx)("title",{children:"".concat(t.name," - Run | Tungsten")}),(0,d.jsx)("meta",{name:"viewport",content:"initial-scale=1.0, width=device-width"})]}),(0,d.jsx)(L,{model:t,children:(0,d.jsx)(ng,{model:t})})]}):void 0,(0,d.jsx)(x.f,{visible:null==t})]})}},7579:function(){}},function(e){e.O(0,[544,347,774,888,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);